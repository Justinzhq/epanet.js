<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="utf-8"/>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
    <title>epanet.js</title>
  
    <script src="http://d3js.org/d3.v3.min.js"></script>
    <script type="text/javascript" src="js/d3epanet.js"></script>
    
     <!-- Bootstrap header -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <link href="css/bootstrap.css" rel="stylesheet"/>
    <link href="css/bootstrap-responsive.css" rel="stylesheet"/>
    
    <link rel="stylesheet" href="css/d3epanet.css" />
  </head>
  <body>
      
      
    <!-- NAVBAR
    ================================================== -->
    <div class="navbar-wrapper">
      <!-- Wrap the .navbar in .container to center it within the absolutely positioned parent. -->
      <div class="container">

        <div class="navbar navbar-inverse">
          <div class="navbar-inner">
            <!-- Responsive Navbar Part 1: Button for triggering responsive navbar (not covered in tutorial). Include responsive CSS to utilize. -->
            <button type="button" class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
              <span class="icon-bar"></span>
              <span class="icon-bar"></span>
              <span class="icon-bar"></span>
            </button>
            <a class="brand" href="#">epanet.js</a>
            <!-- Responsive Navbar Part 2: Place all navbar contents you want collapsed withing .navbar-collapse.collapse. -->
            <div class="nav-collapse collapse">
              <ul class="nav">
                <li class="active"><a href="http://epanet.de/">epanet.de</a></li>
                <!-- Read about Bootstrap dropdowns at http://twbs.github.com/bootstrap/javascript.html#dropdowns -->
                <li class="dropdown">
                  <a href="#" class="dropdown-toggle" data-toggle="dropdown">Samples <b class="caret"></b></a>
                  <ul class="dropdown-menu">
                    <li><a href="#">simple.inp</a></li>
                    <li class="divider"></li>
                    <li class="nav-header">Nav header</li>
                    <li><a href="#">Separated link</a></li>
                    <li><a href="#">One more separated link</a></li>
                  </ul>
                </li>
              </ul>
            </div><!--/.nav-collapse -->
          </div><!-- /.navbar-inner -->
        </div><!-- /.navbar -->

      </div> <!-- /.container -->
    </div><!-- /.navbar-wrapper -->



    <!-- Carousel
    ================================================== -->
    <div id="myCarousel" class="carousel slide">
      <div class="carousel-inner">
        <div class="item active" id="simple_model">          
          <div class="container">
            <div class="carousel-caption">
              <h1>Simplified model</h1>              
              <a class="btn btn-large btn-primary" href="javascript:runButton();">Run analysis</a>
            </div>
          </div>
        </div>
        <div class="item" id="analysis_model">
          <div class="container">
            <div class="carousel-caption">
              <h1>Analysis model</h1>
              <p class="lead">Overview.</p>
              <a class="btn btn-large btn-primary" href="javascript:runButton();">Run analysis</a>
            </div>
          </div>
        </div>
      </div>
      <a class="left carousel-control" href="#myCarousel" data-slide="prev">&lsaquo;</a>
      <a class="right carousel-control" href="#myCarousel" data-slide="next">&rsaquo;</a>
    </div><!-- /.carousel -->



    <!-- Marketing messaging and featurettes
    ================================================== -->
    <!-- Wrap the rest of the page in another container to center all the content. -->

    <div class="container marketing">

      <!-- Three columns of text below the carousel -->
      <div class="row">
        <div class="span8">
          <img class="img-circle" data-src="holder.js/140x140">
          <h2>Input</h2>        
          <p><input class="btn btn-larg" type="file" id="file" style="display: none"/> <a class="btn btn-large" href="#">Save</a></p>
           <pre id="input">
[TITLE]
Simple epanet.js model

[JUNCTIONS] ; created by GHydraulics
PUMP1 25 0 
PUMP1dn 25 0 
J1 25   
G 0 351  
J0 25   

[RESERVOIRS] ; created by GHydraulics
R1 25  

[TANKS] ; created by GHydraulics

[PIPES] ; created by GHydraulics
P4 J1 G 740.791 100 0.1 0 OPEN 
P2 J0 PUMP1 2.208 100 0.1 0 OPEN 
P3 PUMP1dn J1 2.68 100 0.1 0 OPEN 
P1 R1 J0 1.052 100 0.1 0 OPEN 

[PUMPS] ; created by GHydraulics
PUMP1 PUMP1 PUMP1dn POWER 0.1 

[VALVES] ; created by GHydraulics

[TAGS]

[DEMANDS]
;Junction        	Demand      	Pattern         	Category

[STATUS]
;ID              	Status/Setting

[PATTERNS]
;ID              	Multipliers

[CURVES]
;ID              	X-Value     	Y-Value

[CONTROLS]

[RULES]

[ENERGY]
 Global Efficiency  	75
 Global Price       	0
 Demand Charge      	0

[EMITTERS]
;Junction        	Coefficient

[QUALITY]
;Node            	InitQual

[SOURCES]
;Node            	Type        	Quality     	Pattern

[REACTIONS]
;Type     	Pipe/Tank       	Coefficient


[REACTIONS]
 Order Bulk            	1
 Order Tank            	1
 Order Wall            	1
 Global Bulk           	0
 Global Wall           	0
 Limiting Potential    	0
 Roughness Correlation 	0

[MIXING]
;Tank            	Model

[TIMES]
 Duration           	0
 Hydraulic Timestep 	1:00
 Quality Timestep   	0:05
 Pattern Timestep   	1:00
 Pattern Start      	0:00
 Report Timestep    	1:00
 Report Start       	0:00
 Start ClockTime    	12 am
 Statistic          	None

[REPORT]
 Status             	Yes
 Summary                Yes
 Page               	0
 Nodes                  All
 Links                  All

[OPTIONS]
 Units              	CMD
 Headloss           	D-W
 Specific Gravity   	1
 Viscosity          	1
 Trials             	40
 Accuracy           	0.001
 CHECKFREQ          	2
 MAXCHECK           	10
 DAMPLIMIT          	0
 Unbalanced         	Continue 10
 Pattern            	1
 Demand Multiplier  	1.0
 Emitter Exponent   	0.5
 Quality            	None mg/L
 Diffusivity        	1
 Tolerance          	0.01

[COORDINATES] ; created by GHydraulics
PUMP1 10.1661784174 51.8015397878
PUMP1dn 10.1661922403 51.8015313179
J1 10.1662060632 51.8015228479
G 10.176376908 51.7997067163
J0 10.1661583145 51.8015552353
R1 10.1661502734 51.8015632765
[VERTICES] ; created by GHydraulics
P4 10.1665175862 51.8013427744
P4 10.1709055563 51.8008257206
P4 10.1721213314 51.8005741809
P4 10.1740358279 51.8004623855
P4 10.1763416084 51.7997357153
P2 10.1661784174 51.8015397878
[LABELS]
;X-Coord           Y-Coord          Label & Anchor Node

[BACKDROP]

[END]</pre>
        </div><!-- /.span8 -->
        <div class="span8">
          <img class="img-circle" data-src="holder.js/140x140">
          <h2>Analysis</h2>          
          <p><a class="btn" href="#">View details &raquo;</a></p>
          <pre id="output"></pre>
        </div><!-- /.span8 -->        
      </div><!-- /.row -->

      
      <!-- FOOTER -->
      <footer>
        <p class="pull-right"><a href="#">Back to top</a></p>
        <p>&copy; 2013 Steffen Macke <a href="mailto:sdteffen@gmail.com">sdteffen@gmail.com</a> &middot; <a href="http://epanet.de/privacypolicy.html.en">Privacy</a> &middot; <a href="http://epanet.de/imprint.html.en">Imprint</a></p>
      </footer>

    </div><!-- /.container -->



    <!-- Le javascript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script src="http://code.jquery.com/jquery.js"></script>
    <script src="js/bootstrap.min.js"></script>
    <script>
      !function ($) {
        $(function(){
          // carousel demo
          $('#myCarousel').carousel()
        })
      }(window.jQuery)
    </script>
      
      
        <div id="status">epanet.js...</div>
    
  </body>
  <script type="text/javascript">
if(window.File && window.FileReader && window.FileList)
  document.getElementById('file').style.display = 'block';
function handleFileSelect(evt) {
  if(!evt.target || !evt.target.files || !evt.target.files.length || 0 == evt.target.files.length)
	return;
	
  var f = evt.target.files[0],
    reader = new FileReader();
  reader.onload = (function(theFile) {
            return function(e) {
              document.getElementById('input').value = e.target.result;
	      runButton();
            };
          })(f);

  reader.readAsText(f);
}
document.getElementById('file').addEventListener('change', handleFileSelect, false);

      // connect to canvas
      var Module = {
        preRun: [],
        postRun: [],
        print: (function() {
          var element = document.getElementById('output');
          element.innerHTML = ''; // clear browser cache
          return function(text) {
            element.innerHTML += text + "\n";
            element.scrollTop = 99999; // focus on bottom
          };
        })(),
        printErr: function(text) {
          if (0) { // XXX disabled for safety typeof dump == 'function') {
            dump(text + '\n'); // fast, straight to the real console
          } else {
            console.log(text);
          }
        },
        canvas: document.getElementById('canvas'),
        setStatus: function(text) {
          
        },
        totalDependencies: 0,
        monitorRunDependencies: function(left) {
          this.totalDependencies = Math.max(this.totalDependencies, left);
          Module.setStatus(left ? 'Preparing... (' + (this.totalDependencies-left) + '/' + this.totalDependencies + ')' : 'All downloads complete.');
        }
      };
      Module.setStatus('Preparing...');
    
      {{{ SCRIPT_CODE }}}

    </script>
</html>
